version: "3.8"

services:
  i2pd:
    image: purplei2p/i2pd:latest
    container_name: i2p_router
    ports:
      - "127.0.0.1:7656:7656" # SAM API (localhost only)
      - "127.0.0.1:4444:4444" # HTTP Proxy (optional)
      - "127.0.0.1:7070:7070" # Web console (optional)
    volumes:
      - i2pd_data:/home/i2pd/data
    environment:
      - SAM_ENABLED=true
    command: >
      --sam.enabled=true
      --sam.address=0.0.0.0
      --sam.port=7656
      --http.enabled=true
      --http.address=0.0.0.0
      --httpproxy.enabled=true
      --httpproxy.address=0.0.0.0
      --loglevel=warn
    restart: unless-stopped
    networks:
      - i2p_network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:7070"]
      interval: 30s
      timeout: 10s
      retries: 3

volumes:
  i2pd_data:

networks:
  i2p_network:
    driver: bridge
